Refactor methods for path calculation

This allows other scripts to access this logic.
@gunan This is what I meant.