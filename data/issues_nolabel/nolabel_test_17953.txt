Do not follow control edges in segmenter and in conversion and (#17936)

gracefully handle some failures
(cherry picked from commit 5daa95e)
(cherry picked from commit ee87a13)
(cherry picked from commit 9a1e6b0)
and squashed