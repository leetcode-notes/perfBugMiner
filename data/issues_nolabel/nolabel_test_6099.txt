Cherrypicks into r0.12 release

This is wave 1, with some merge conflicts. @mrry PTAL