R0.8 tensorforest cherry-pick

This PR also contains a small amount of other changes pushed from internal.