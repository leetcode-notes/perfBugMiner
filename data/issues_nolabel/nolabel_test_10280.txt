Compare base_dtype instead of dtype in piecewise_constant

Compare base_dtype instead of dtype in piecewise_constant. Fix #10086