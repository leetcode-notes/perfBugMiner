Fix defect: shuffle_batch gives ZeroDivisionError when computing capacity stat

bug fix for #1853