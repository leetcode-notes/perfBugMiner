fix memory leak, and remove duplicated implements

fix memory leak, and remove duplicated implements.