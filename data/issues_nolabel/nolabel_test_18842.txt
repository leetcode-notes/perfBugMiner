Fix a bug where string::substr is used with wrong position.

@samikama