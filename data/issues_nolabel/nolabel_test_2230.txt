Merge changes from the last several days

This was a pretty hard conflict to resolve from internal to external, so we'll see if I did it right.