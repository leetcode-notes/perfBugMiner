Add further changes for complex128 support

I'm now back to working on extending the existing ops to support complex128 where appropriate.
This addresses #1517.
This is not close to being complete yet, but I thought I should start a PR.