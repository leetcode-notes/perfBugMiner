Branch 136497385

See merge comments about conflicts with #4684 and #5009.