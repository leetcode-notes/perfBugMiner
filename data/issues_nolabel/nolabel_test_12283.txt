Cherrypicks

@wolffg had to patch yours in in the last commit, please verify everything is right.