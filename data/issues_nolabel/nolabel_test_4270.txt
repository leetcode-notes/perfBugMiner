Fix the issue#4138

Fix the issue #4138
Redefine the w and w_t for improving the efficiency in case of handling sparse IndexedSlices objects