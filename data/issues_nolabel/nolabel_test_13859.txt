Merge two GPU kernel launching to one in DiagOp

The PR is the following update for the discussion of #13666, which tries to merge two GPU kernel launching to one launching in DiagOp, as @ekelsen suggested.