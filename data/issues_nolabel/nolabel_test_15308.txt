improve compute high rank hessians

fix possible compute high rank hessians