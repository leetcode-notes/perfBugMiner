Fix NadamOptimizer to work with sparse gradients properly

Fix for #15035 and  #13980