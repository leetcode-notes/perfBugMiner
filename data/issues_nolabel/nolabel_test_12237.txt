CUDA_ERROR_OUT_OF_MEMORY

$ python run_atari.py
2017-08-12 08:25:13.924739: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.924772: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.924778: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.924781: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.924785: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.924993: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925079: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925109: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925135: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925154: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925180: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925191: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925209: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925249: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.925290: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.930447: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.930465: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.930468: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.930471: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.930473: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.932529: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.932550: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.932555: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.932560: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.932564: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.938520: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.938540: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.938546: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.938550: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.938554: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.943387: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.943402: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.943406: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.943409: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.943412: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.969437: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.1 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.969456: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use SSE4.2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.969460: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.969462: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use AVX2 instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:13.969465: W tensorflow/core/platform/cpu_feature_guard.cc:45] The TensorFlow library wasn't compiled to use FMA instructions, but these are available on your machine and could speed up CPU computations.
2017-08-12 08:25:14.793472: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties:
name: Quadro P400
major: 6 minor: 1 memoryClockRate (GHz) 1.2525
pciBusID 0000:01:00.0
Total memory: 1.94GiB
Free memory: 1.71GiB
2017-08-12 08:25:14.793509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0
2017-08-12 08:25:14.793515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y
2017-08-12 08:25:14.793530: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Quadro P400, pci bus id: 0000:01:00.0)
2017-08-12 08:25:14.793544: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties:
name: Quadro P400
major: 6 minor: 1 memoryClockRate (GHz) 1.2525
pciBusID 0000:01:00.0
Total memory: 1.94GiB
Free memory: 1.71GiB
2017-08-12 08:25:14.793565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0
2017-08-12 08:25:14.793569: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y
2017-08-12 08:25:14.793574: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Quadro P400, pci bus id: 0000:01:00.0)
2017-08-12 08:25:14.794371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties:
name: Quadro P400
major: 6 minor: 1 memoryClockRate (GHz) 1.2525
pciBusID 0000:01:00.0
Total memory: 1.94GiB
Free memory: 1.71GiB
2017-08-12 08:25:14.794393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0
2017-08-12 08:25:14.794400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y
2017-08-12 08:25:14.794414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Quadro P400, pci bus id: 0000:01:00.0)
2017-08-12 08:25:14.797353: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.52G (1631518720 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.798216: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 199.94M (209649664 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.798345: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.37G (1468366848 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.802545: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.23G (1321530112 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.803248: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.11G (1189377024 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.803964: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1020.85M (1070439424 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.804914: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 918.77M (963395584 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.806389: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 826.89M (867056128 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
[2017-08-12 08:25:14,806] Making new env: PongNoFrameskip-v4
2017-08-12 08:25:14.807060: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 744.20M (780350464 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
[2017-08-12 08:25:14,807] Making new env: PongNoFrameskip-v4
2017-08-12 08:25:14.811390: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 669.78M (702315520 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.812196: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 602.80M (632083968 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.813940: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 542.52M (568875776 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.814633: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 488.27M (511988224 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.814680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:940] Found device 0 with properties:
name: Quadro P400
major: 6 minor: 1 memoryClockRate (GHz) 1.2525
pciBusID 0000:01:00.0
Total memory: 1.94GiB
Free memory: 5.94MiB
2017-08-12 08:25:14.814703: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0
2017-08-12 08:25:14.814712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y
2017-08-12 08:25:14.814728: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Quadro P400, pci bus id: 0000:01:00.0)
2017-08-12 08:25:14.818246: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 439.44M (460789504 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.818910: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 7.94M (8323072 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.819004: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 395.50M (414710528 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.819713: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 7.14M (7490816 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.820048: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 355.95M (373239552 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.820746: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 6.43M (6741760 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.822546: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 320.35M (335915776 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.823119: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 5.79M (6067712 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.823313: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 288.32M (302324224 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.823724: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 5.21M (5460992 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.823876: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 259.49M (272091904 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.828059: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 4.69M (4914944 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.828254: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 233.54M (244882944 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.830112: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 4.22M (4423680 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.830394: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 210.18M (220394752 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.831054: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 189.17M (198355456 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.834707: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 170.25M (178520064 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.835248: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 153.22M (160668160 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.835705: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 137.90M (144601344 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
[2017-08-12 08:25:14,835] Making new env: PongNoFrameskip-v4
2017-08-12 08:25:14.837829: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 124.11M (130141440 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.838592: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 111.70M (117127424 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.840518: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 100.53M (105414912 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.841699: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 90.48M (94873600 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.845234: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 81.43M (85386240 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.845857: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 73.29M (76847616 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.846513: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 65.96M (69163008 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.847151: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 59.36M (62246912 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.849240: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 53.43M (56022272 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.850945: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 48.08M (50420224 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.851940: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 43.28M (45378304 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.855851: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 38.95M (40840704 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.856374: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 35.05M (36756736 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.857234: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 31.55M (33081088 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.857762: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 28.39M (29773056 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.858341: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 25.55M (26795776 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.858817: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 23.00M (24116224 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.859718: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 20.70M (21704704 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.860385: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 18.63M (19534336 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:14.860857: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 16.77M (17581056 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
[2017-08-12 08:25:14,863] Making new env: PongNoFrameskip-v4
2017-08-12 08:25:15.081855: E tensorflow/core/common_runtime/direct_session.cc:138] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_UNKNOWN
Traceback (most recent call last):
  File "run_atari.py", line 55, in <module>
    main()
  File "run_atari.py", line 52, in main
    train('PongNoFrameskip-v4', num_timesteps=40e6, seed=0, num_cpu=8)
  File "run_atari.py", line 24, in train
    sess = U.single_threaded_session()
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 233, in single_threaded_session
    return make_session(1)
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 228, in make_session
    return tf.Session(config=tf_config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1292, in __init__
    super(Session, self).__init__(target, graph, config=config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 562, in __init__
    self._session = tf_session.TF_NewDeprecatedSession(opts, status)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/contextlib.py", line 89, in __exit__
    next(self.gen)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Failed to create session.
2017-08-12 08:25:15.099150: E tensorflow/core/common_runtime/direct_session.cc:138] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_UNKNOWN
Traceback (most recent call last):
  File "run_atari.py", line 55, in <module>
    main()
  File "run_atari.py", line 52, in main
    train('PongNoFrameskip-v4', num_timesteps=40e6, seed=0, num_cpu=8)
  File "run_atari.py", line 24, in train
    sess = U.single_threaded_session()
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 233, in single_threaded_session
    return make_session(1)
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 228, in make_session
    return tf.Session(config=tf_config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1292, in __init__
    super(Session, self).__init__(target, graph, config=config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 562, in __init__
    self._session = tf_session.TF_NewDeprecatedSession(opts, status)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/contextlib.py", line 89, in __exit__
    next(self.gen)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Failed to create session.
2017-08-12 08:25:15.121723: E tensorflow/core/common_runtime/direct_session.cc:138] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_OUT_OF_MEMORY; total memory reported: 2086797312
Traceback (most recent call last):
  File "run_atari.py", line 55, in <module>
    main()
  File "run_atari.py", line 52, in main
    train('PongNoFrameskip-v4', num_timesteps=40e6, seed=0, num_cpu=8)
  File "run_atari.py", line 24, in train
    sess = U.single_threaded_session()
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 233, in single_threaded_session
    return make_session(1)
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 228, in make_session
    return tf.Session(config=tf_config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1292, in __init__
    super(Session, self).__init__(target, graph, config=config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 562, in __init__
    self._session = tf_session.TF_NewDeprecatedSession(opts, status)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/contextlib.py", line 89, in __exit__
    next(self.gen)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Failed to create session.
2017-08-12 08:25:15.138143: E tensorflow/core/common_runtime/direct_session.cc:138] Internal: failed initializing StreamExecutor for CUDA device ordinal 0: Internal: failed call to cuDevicePrimaryCtxRetain: CUDA_ERROR_UNKNOWN
Traceback (most recent call last):
  File "run_atari.py", line 55, in <module>
    main()
  File "run_atari.py", line 52, in main
    train('PongNoFrameskip-v4', num_timesteps=40e6, seed=0, num_cpu=8)
  File "run_atari.py", line 24, in train
    sess = U.single_threaded_session()
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 233, in single_threaded_session
    return make_session(1)
  File "/nohome/jaan/abhishek/code/baselines/baselines/common/tf_util.py", line 228, in make_session
    return tf.Session(config=tf_config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 1292, in __init__
    super(Session, self).__init__(target, graph, config=config)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/client/session.py", line 562, in __init__
    self._session = tf_session.TF_NewDeprecatedSession(opts, status)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/contextlib.py", line 89, in __exit__
    next(self.gen)
  File "/nohome/jaan/abhishek/anaconda3/lib/python3.6/site-packages/tensorflow/python/framework/errors_impl.py", line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Failed to create session.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,309] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,310] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,344] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,344] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,373] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,373] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,385] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
WARNING:tensorflow:VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
[2017-08-12 08:25:16,385] VARIABLES collection name is deprecated, please use GLOBAL_VARIABLES instead; VARIABLES will be removed after 2017-03-02.
2017-08-12 08:25:16.507902: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.51G (1617277696 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
2017-08-12 08:25:16.508376: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.51G (1617277696 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY
Job 1, 'python run_atari.py' has stopped

It fails, even when the memory is there!
Total memory: 1.94GiB
Free memory: 1.71GiB
2017-08-12 08:25:14.794393: I tensorflow/core/common_runtime/gpu/gpu_device.cc:961] DMA: 0
2017-08-12 08:25:14.794400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:971] 0:   Y
2017-08-12 08:25:14.794414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Creating TensorFlow device (/gpu:0) -> (device: 0, name: Quadro P400, pci bus id: 0000:01:00.0)
2017-08-12 08:25:14.797353: E tensorflow/stream_executor/cuda/cuda_driver.cc:924] failed to allocate 1.52G (1631518720 bytes) from device: CUDA_ERROR_OUT_OF_MEMORY

$ nvidia-smi
Sat Aug 12 08:34:26 2017
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 375.82                 Driver Version: 375.82                    |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  Quadro P400         Off  | 0000:01:00.0      On |                  N/A |
| 41%   50C    P8    12W /  N/A |    116MiB /  1990MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   1  Tesla K40c          Off  | 0000:03:00.0     Off |                    0 |
| 26%   49C    P8    21W / 235W |      0MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+
|   2  Tesla K40c          Off  | 0000:04:00.0     Off |                    0 |
| 28%   54C    P8    30W / 235W |      0MiB / 11439MiB |      0%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
|    0      1835    G   /usr/lib/xorg/Xorg                              60MiB |
|    0      1946    G   gnome-shell                                     54MiB |
+-----------------------------------------------------------------------------+