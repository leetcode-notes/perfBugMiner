Branch 155030326

I squashed the last branch by accident, so resolving conflicts had to be manual.  Let's hope I got them right.